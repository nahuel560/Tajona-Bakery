(function(o,a,n,i){var t=function(i,t){this.elem=i;this.$elem=o(i);this.options=t;this.metadata=this.$elem.data("plugin-options");this.$win=o(a);this.sections={};this.didScroll=false;this.$doc=o(n);this.docHeight=this.$doc.height()};t.prototype={defaults:{navItems:"a",currentClass:"current",changeHash:false,easing:"swing",filter:"",scrollSpeed:750,scrollThreshold:.5,begin:false,end:false,scrollChange:false},init:function(){this.config=o.extend({},this.defaults,this.options,this.metadata);this.$nav=this.$elem.find(this.config.navItems);if(this.config.filter!==""){this.$nav=this.$nav.filter(this.config.filter)}this.$nav.on("click.onePageNav",o.proxy(this.handleClick,this));this.getPositions();this.bindInterval();this.$win.on("resize.onePageNav",o.proxy(this.getPositions,this));return this},adjustNav:function(i,t){i.$elem.find("."+i.config.currentClass).removeClass(i.config.currentClass);t.addClass(i.config.currentClass)},bindInterval:function(){var i=this;var t;i.$win.on("scroll.onePageNav",function(){i.didScroll=true});i.t=setInterval(function(){t=i.$doc.height();if(i.didScroll){i.didScroll=false;i.scrollChange()}if(t!==i.docHeight){i.docHeight=t;i.getPositions()}},250)},getHash:function(i){return i.attr("href").split("#")[1]},getPositions:function(){var i=this;var t;var n;var e;i.$nav.each(function(){t=i.getHash(o(this));e=o("#"+t);if(e.length){n=e.offset().top;i.sections[t]=Math.round(n)}})},getSection:function(i){var t=null;var n=Math.round(this.$win.height()*this.config.scrollThreshold);for(var e in this.sections){if(this.sections[e]-n-this.headerOffsetTop()<=i){t=e}}return t},headerOffsetTop:function(){var i=G5CORE.getAdminBarHeight();var t=o(".g5core-site-header.header-sticky-simple .sticky-area");if(t.length>0){if(t.css("position")=="fixed"){i+=t.outerHeight()}else{i+=60}}return i},handleClick:function(i){var t=this;var n=o(i.currentTarget);var e=n.parent();var s="#"+t.getHash(n);if(s=="#undefined"){return}if(t.config.begin){t.config.begin()}t.adjustNav(t,e);t.unbindInterval();t.scrollTo(s,function(){if(t.config.changeHash){a.location.hash=s}t.bindInterval();if(t.config.end){t.config.end()}});i.preventDefault()},scrollChange:function(){var i=this.$win.scrollTop();var t=this.getSection(i);var n;if(t!==null){n=this.$elem.find('a[href$="#'+t+'"]').parent();if(!n.hasClass(this.config.currentClass)){this.adjustNav(this,n);if(this.config.scrollChange){this.config.scrollChange(n)}}}},scrollTo:function(i,t){if(o(i).length==0){return}var n=o(i).offset().top-this.headerOffsetTop();o("html, body").animate({scrollTop:n},this.config.scrollSpeed,this.config.easing,t)},unbindInterval:function(){clearInterval(this.t);this.$win.unbind("scroll.onePageNav")}};t.defaults=t.prototype.defaults;o.fn.onePageNav=function(i){return this.each(function(){new t(this,i).init()})}})(jQuery,window,document);